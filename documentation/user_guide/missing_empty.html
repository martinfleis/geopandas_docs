

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Missing and empty geometries &#8212; GeoPandas 0.8.0+24.g33c2772.dirty documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../../index.html">
      <img src="../../_static/geopandas_logo.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../../index.html">Home</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../about.html">About</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../getting_started.html">Getting started</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../documentation.html">Documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../../community.html">Community</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/geopandas/geopandas" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/geopandas" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#changes-since-geopandas-v0-6-0" class="nav-link">Changes since GeoPandas v0.6.0</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="section" id="missing-and-empty-geometries">
<span id="missing-empty"></span><h1>Missing and empty geometries<a class="headerlink" href="#missing-and-empty-geometries" title="Permalink to this headline">Â¶</a></h1>
<p>GeoPandas supports, just like in pandas, the concept of missing values (NA
or null values). But for geometry values, we have an additional concept of
empty geometries:</p>
<ul class="simple">
<li><p><strong>Empty geometries</strong> are actual geometry objects but that have no coordinates
(and thus also no area, for example). They can for example originate from
taking the intersection of two polygons that have no overlap.
The scalar object (when accessing a single element of a GeoSeries) is still
a Shapely geometry object.</p></li>
<li><p><strong>Missing geometries</strong> are unknown values in a GeoSeries. They will typically
be propagated in operations (for example in calculations of the area or of
the intersection), or ignored in reductions such as <code class="docutils literal notranslate"><span class="pre">unary_union</span></code>.
The scalar object (when accessing a single element of a GeoSeries) is the
Python <code class="docutils literal notranslate"><span class="pre">None</span></code> object.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Starting from GeoPandas v0.6.0, those two concepts are more consistently
separated. See <a class="reference internal" href="#missing-empty-changes-0-6-0"><span class="std std-ref">below</span></a> for more details
on what changed compared to earlier versions.</p>
</div>
<p>Consider the following example GeoSeries with one polygon, one missing value
and one empty polygon:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>

<span class="gp">In [2]: </span><span class="n">s</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]),</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Polygon</span><span class="p">([])])</span>

<span class="gp">In [3]: </span><span class="n">s</span>
<span class="gh">Out[3]: </span><span class="go"></span>
<span class="go">0    POLYGON ((0.000000000 0.000000000, 1.000000000...</span>
<span class="go">1                                                 None</span>
<span class="go">2                             GEOMETRYCOLLECTION EMPTY</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
<p>In spatial operations, missing geometries will typically propagate (be missing
in the result as well), while empty geometries are treated as a geometry
and the result will depend on the operation:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">s</span><span class="o">.</span><span class="n">area</span>
<span class="gh">Out[4]: </span><span class="go"></span>
<span class="go">0    0.5</span>
<span class="go">1    NaN</span>
<span class="go">2    0.0</span>
<span class="go">dtype: float64</span>

<span class="gp">In [5]: </span><span class="n">s</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]))</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">0    POLYGON ((0.000000000 1.000000000, 1.000000000...</span>
<span class="go">1                                                 None</span>
<span class="go">2    POLYGON ((0.000000000 0.000000000, 0.000000000...</span>
<span class="go">dtype: geometry</span>

<span class="gp">In [6]: </span><span class="n">s</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">Polygon</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]))</span>
<span class="gh">Out[6]: </span><span class="go"></span>
<span class="go">0    POLYGON ((1.000000000 1.000000000, 0.000000000...</span>
<span class="go">1                                                 None</span>
<span class="go">2                             GEOMETRYCOLLECTION EMPTY</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../api/api/geopandas.GeoSeries.isna.html#geopandas.GeoSeries.isna" title="geopandas.GeoSeries.isna"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoSeries.isna()</span></code></a> method will only check for missing values and not
for empty geometries:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="gh">Out[7]: </span><span class="go"></span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>On the other hand, if you want to know which values are empty geometries,
you can use the <a class="reference internal" href="../api/api/geopandas.GeoSeries.is_empty.html#geopandas.GeoSeries.is_empty" title="geopandas.GeoSeries.is_empty"><code class="xref py py-attr docutils literal notranslate"><span class="pre">GeoSeries.is_empty</span></code></a> attribute:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">s</span><span class="o">.</span><span class="n">is_empty</span>
<span class="gh">Out[8]: </span><span class="go"></span>
<span class="go">0    False</span>
<span class="go">1    False</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>To get only the actual geometry objects that are neiter missing nor empty,
you can use a combination of both:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">s</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="gh">Out[9]: </span><span class="go"></span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>

<span class="gp">In [10]: </span><span class="n">s</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">is_empty</span> <span class="o">|</span> <span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">())]</span>
<span class="gh">Out[10]: </span><span class="go"></span>
<span class="go">0    POLYGON ((0.000000000 0.000000000, 1.000000000...</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
<div class="section" id="changes-since-geopandas-v0-6-0">
<span id="missing-empty-changes-0-6-0"></span><h2>Changes since GeoPandas v0.6.0<a class="headerlink" href="#changes-since-geopandas-v0-6-0" title="Permalink to this headline">Â¶</a></h2>
<p>In GeoPandas v0.6.0, the missing data handling was refactored and made more
consistent across the library.</p>
<p>Historically, missing (âNAâ) values in a GeoSeries could be represented by empty
geometric objects, in addition to standard representations such as <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">np.nan</span></code>. At least, this was the case in <a class="reference internal" href="../api/api/geopandas.GeoSeries.isna.html#geopandas.GeoSeries.isna" title="geopandas.GeoSeries.isna"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoSeries.isna()</span></code></a> or when a
GeoSeries got aligned in geospatial operations. But, other methods like
<code class="xref py py-meth docutils literal notranslate"><span class="pre">dropna()</span></code> and <a class="reference internal" href="../api/api/geopandas.GeoSeries.fillna.html#geopandas.GeoSeries.fillna" title="geopandas.GeoSeries.fillna"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fillna()</span></code></a> did not follow this
approach and did not consider empty geometries as missing.</p>
<p>In GeoPandas v0.6.0, the most important change is <a class="reference internal" href="../api/api/geopandas.GeoSeries.isna.html#geopandas.GeoSeries.isna" title="geopandas.GeoSeries.isna"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoSeries.isna()</span></code></a> no
longer treating empty as missing:</p>
<ul>
<li><p>Using the small example from above, the old behaviour treated both the
empty as missing geometry as âmissingâ:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">0    POLYGON ((0 0, 1 1, 0 1, 0 0))</span>
<span class="go">1                              None</span>
<span class="go">2          GEOMETRYCOLLECTION EMPTY</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2     True</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
</li>
<li><p>Starting from GeoPandas v0.6.0, it will now only see actual missing values
as missing:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [11]: </span><span class="n">s</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span>
<span class="gh">Out[11]: </span><span class="go"></span>
<span class="go">0    False</span>
<span class="go">1     True</span>
<span class="go">2    False</span>
<span class="go">dtype: bool</span>
</pre></div>
</div>
<p>For now, when <code class="docutils literal notranslate"><span class="pre">isna()</span></code> is called on a GeoSeries with empty geometries,
a warning is raised to alert the user of the changed behaviour with an
indication how to solve this.</p>
</li>
</ul>
<p>Additionally, the behaviour of <code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoSeries.align()</span></code> changed to use
missing values instead of empty geometries to fill non-matching indexes.
Consider the following small toy example:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>

<span class="gp">In [13]: </span><span class="n">s1</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="gp">In [14]: </span><span class="n">s2</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">([</span><span class="n">Point</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="gp">In [15]: </span><span class="n">s1</span>
<span class="gh">Out[15]: </span><span class="go"></span>
<span class="go">0    POINT (0.000000000 0.000000000)</span>
<span class="go">1    POINT (1.000000000 1.000000000)</span>
<span class="go">dtype: geometry</span>

<span class="gp">In [16]: </span><span class="n">s2</span>
<span class="gh">Out[16]: </span><span class="go"></span>
<span class="go">1    POINT (1.000000000 1.000000000)</span>
<span class="go">2    POINT (2.000000000 2.000000000)</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
<ul>
<li><p>Previously, the <code class="docutils literal notranslate"><span class="pre">align</span></code> method would use empty geometries to fill
values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1_aligned</span><span class="p">,</span> <span class="n">s2_aligned</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s1_aligned</span>
<span class="go">0                 POINT (0 0)</span>
<span class="go">1                 POINT (1 1)</span>
<span class="go">2    GEOMETRYCOLLECTION EMPTY</span>
<span class="go">dtype: object</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s2_aligned</span>
<span class="go">0    GEOMETRYCOLLECTION EMPTY</span>
<span class="go">1                 POINT (1 1)</span>
<span class="go">2                 POINT (2 2)</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>This method is used under the hood when performing spatial operations on
mis-aligned GeoSeries objects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="go">0    GEOMETRYCOLLECTION EMPTY</span>
<span class="go">1                 POINT (1 1)</span>
<span class="go">2    GEOMETRYCOLLECTION EMPTY</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
</li>
<li><p>Starting from GeoPandas v0.6.0, <code class="xref py py-meth docutils literal notranslate"><span class="pre">GeoSeries.align()</span></code> will use missing
values to fill in the non-aligned indices, to be consistent with the
behaviour in pandas:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">s1_aligned</span><span class="p">,</span> <span class="n">s2_aligned</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">align</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>

<span class="gp">In [18]: </span><span class="n">s1_aligned</span>
<span class="gh">Out[18]: </span><span class="go"></span>
<span class="go">0    POINT (0.000000000 0.000000000)</span>
<span class="go">1    POINT (1.000000000 1.000000000)</span>
<span class="go">2                               None</span>
<span class="go">dtype: geometry</span>

<span class="gp">In [19]: </span><span class="n">s2_aligned</span>
<span class="gh">Out[19]: </span><span class="go"></span>
<span class="go">0                               None</span>
<span class="go">1    POINT (1.000000000 1.000000000)</span>
<span class="go">2    POINT (2.000000000 2.000000000)</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
<p>This has the consequence that spatial operations will also use missing
values instead of empty geometries, which can have a different behaviour
depending on the spatial operation:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [20]: </span><span class="n">s1</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="gh">Out[20]: </span><span class="go"></span>
<span class="go">0                               None</span>
<span class="go">1    POINT (1.000000000 1.000000000)</span>
<span class="go">2                               None</span>
<span class="go">dtype: geometry</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2013â2019, GeoPandas developers.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>