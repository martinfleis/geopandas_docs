

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Plotting with CartoPy and GeoPandas &#8212; GeoPandas 0.8.0+28.g70986c0.dirty documentation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation" href="../docs.html" />
    <link rel="prev" title="Clip Vector Data with GeoPandas" href="plot_clip.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main">
<div class="container-xl">

    
    <a class="navbar-brand" href="../index.html">
      <img src="../_static/geopandas_logo.svg" class="logo" alt="logo">
    </a>
    
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-menu" aria-controls="navbar-menu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar-menu" class="col-lg-9 collapse navbar-collapse">
      <ul id="navbar-main-elements" class="navbar-nav mr-auto">
        
        
        <li class="nav-item ">
            <a class="nav-link" href="../index.html">Home</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../about.html">About</a>
        </li>
        
        <li class="nav-item active">
            <a class="nav-link" href="../getting_started.html">Getting started</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../docs.html">Documentation</a>
        </li>
        
        <li class="nav-item ">
            <a class="nav-link" href="../community.html">Community</a>
        </li>
        
        
      </ul>


      

      <ul class="navbar-nav">
        
          <li class="nav-item">
            <a class="nav-link" href="https://github.com/geopandas/geopandas" target="_blank" rel="noopener">
              <span><i class="fab fa-github-square"></i></span>
            </a>
          </li>
        
        
          <li class="nav-item">
            <a class="nav-link" href="https://twitter.com/geopandas" target="_blank" rel="noopener">
              <span><i class="fab fa-twitter-square"></i></span>
            </a>
          </li>
        
      </ul>
    </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
          <div class="col-12 col-md-3 bd-sidebar">

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>


<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">

  <div class="bd-toc-item active">
  

  <ul class="nav bd-sidenav">
      
      
      
      
      
      
        
          
              <li class="">
                  <a href="../getting_started/install.html">Installation</a>
              </li>
          
        
          
              <li class="">
                  <a href="../getting_started/introduction.html">Introduction to GeoPandas</a>
              </li>
          
        
          

              <li class="active">
                  <a href="index.html">Examples Gallery</a>
                  <ul>
                  
                      <li class="">
                          <a href="plotting_basemap_background.html">Adding a background map to plots</a>
                      </li>
                  
                      <li class="">
                          <a href="create_geopandas_from_pandas.html">Creating a GeoDataFrame from a DataFrame with coordinates</a>
                      </li>
                  
                      <li class="">
                          <a href="plotting_with_geoplot.html">Plotting with Geoplot and GeoPandas</a>
                      </li>
                  
                      <li class="">
                          <a href="plot_clip.html">Clip Vector Data with GeoPandas</a>
                      </li>
                  
                      <li class="active">
                          <a href="">Plotting with CartoPy and GeoPandas</a>
                      </li>
                  
                  </ul>
              </li>
          
        
      
      
      
      
      
      
    </ul>

</nav>
          </div>
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
              
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#plotting-with-cartopy" class="nav-link">Plotting with CartoPy</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#cartopy-to-geopandas" class="nav-link">CartoPy to GeoPandas</a>
        </li>
    
    </ul>
</nav>


              
          </div>
          

          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-gallery-cartopy-convert-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="plotting-with-cartopy-and-geopandas">
<span id="sphx-glr-gallery-cartopy-convert-py"></span><h1>Plotting with CartoPy and GeoPandas<a class="headerlink" href="#plotting-with-cartopy-and-geopandas" title="Permalink to this headline">¶</a></h1>
<p>Converting between GeoPandas and CartoPy for visualizing data.</p>
<p><a class="reference external" href="http://scitools.org.uk/cartopy/">CartoPy</a> is a Python library
that specializes in creating geospatial
visualizations. It has a slightly different way of representing
Coordinate Reference Systems (CRS) as well as constructing plots.
This example steps through a round-trip transfer of data
between GeoPandas and CartoPy.</p>
<p>First we’ll load in the data using GeoPandas.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 7</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">geopandas</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">crs</span> <span class="k">as</span> <span class="n">ccrs</span>

<span class="n">path</span> <span class="o">=</span> <a href="../reference/geopandas.datasets.get_path.html#geopandas.datasets.get_path" title="View documentation for geopandas.datasets.get_path"><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span></a><span class="p">(</span><span class="s1">&#39;naturalearth_lowres&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <a href="../reference/geopandas.read_file.html#geopandas.read_file" title="View documentation for geopandas.read_file"><span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span></a><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="c1"># Add a column we&#39;ll use later</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_pp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_md_est&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pop_est&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>First we’ll visualize the map using GeoPandas</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_001.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_001.png" />
<div class="section" id="plotting-with-cartopy">
<h2>Plotting with CartoPy<a class="headerlink" href="#plotting-with-cartopy" title="Permalink to this headline">¶</a></h2>
<p>Cartopy also handles Shapely objects well, but it uses a different system for
CRS. To plot this data with CartoPy, we’ll first need to project it into a
new CRS. We’ll use a CRS defined within CartoPy and use the GeoPandas
<code class="docutils literal notranslate"><span class="pre">to_crs</span></code> method to make the transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the CartoPy CRS object.</span>
<span class="n">crs</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">AzimuthalEquidistant</span><span class="p">()</span>

<span class="c1"># This can be converted into a `proj4` string/dict compatible with GeoPandas</span>
<span class="n">crs_proj4</span> <span class="o">=</span> <span class="n">crs</span><span class="o">.</span><span class="n">proj4_init</span>
<span class="n">df_ae</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">crs_proj4</span><span class="p">)</span>

<span class="c1"># Here&#39;s what the plot looks like in GeoPandas</span>
<span class="n">df_ae</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_002.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_002.png" />
<p>Now that our data is in a CRS based off of CartoPy, we can easily
plot it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">crs</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">df_ae</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_003.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_003.png" />
<p>Note that we could have easily done this with an EPSG code like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crs_epsg</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">epsg</span><span class="p">(</span><span class="s1">&#39;3857&#39;</span><span class="p">)</span>
<span class="n">df_epsg</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="n">epsg</span><span class="o">=</span><span class="s1">&#39;3857&#39;</span><span class="p">)</span>

<span class="c1"># Generate a figure with two axes, one for CartoPy, one for GeoPandas</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">crs_epsg</span><span class="p">},</span>
                        <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># Make the CartoPy plot</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">df_epsg</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs_epsg</span><span class="p">,</span>
                      <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Make the GeoPandas plot</span>
<span class="n">df_epsg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_004.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_004.png" />
</div>
<div class="section" id="cartopy-to-geopandas">
<h2>CartoPy to GeoPandas<a class="headerlink" href="#cartopy-to-geopandas" title="Permalink to this headline">¶</a></h2>
<p>Next we’ll perform a CRS projection in CartoPy, and then convert it
back into a GeoPandas object.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">crs_new</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">AlbersEqualArea</span><span class="p">()</span>
<span class="n">new_geometries</span> <span class="o">=</span> <span class="p">[</span><span class="n">crs_new</span><span class="o">.</span><span class="n">project_geometry</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">src_crs</span><span class="o">=</span><span class="n">crs</span><span class="p">)</span>
                  <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">df_ae</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">crs_new</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">new_geometries</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs_new</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_005.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_005.png" />
<p>Now that we’ve created new Shapely objects with the CartoPy CRS,
we can use this to create a GeoDataFrame.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df_aea</span> <span class="o">=</span> <a href="../reference/geopandas.GeoDataFrame.html#geopandas.GeoDataFrame" title="View documentation for geopandas.GeoDataFrame"><span class="n">geopandas</span><span class="o">.</span><span class="n">GeoDataFrame</span></a><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;gdp_pp&#39;</span><span class="p">],</span> <span class="n">geometry</span><span class="o">=</span><span class="n">new_geometries</span><span class="p">,</span>
                                <span class="n">crs</span><span class="o">=</span><span class="n">crs_new</span><span class="o">.</span><span class="n">proj4_init</span><span class="p">)</span>
<span class="n">df_aea</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_006.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_006.png" />
<p>We can even combine these into the same figure. Here we’ll plot the
shapes of the countries with CartoPy. We’ll then calculate the centroid
of each with GeoPandas and plot it on top.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate a CartoPy figure and add the countries to it</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">crs_new</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_geometries</span><span class="p">(</span><span class="n">new_geometries</span><span class="p">,</span> <span class="n">crs</span><span class="o">=</span><span class="n">crs_new</span><span class="p">)</span>

<span class="c1"># Calculate centroids and plot</span>
<span class="n">df_aea_centroids</span> <span class="o">=</span> <span class="n">df_aea</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">centroid</span>
<span class="c1"># Need to provide &quot;zorder&quot; to ensure the points are plotted above the polygons</span>
<span class="n">df_aea_centroids</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/sphx_glr_cartopy_convert_007.png" class="sphx-glr-single-img" src="../_images/sphx_glr_cartopy_convert_007.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  2.390 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-cartopy-convert-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/72e4c1c14262621007b6c2767d383076/cartopy_convert.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">cartopy_convert.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../_downloads/0c3d8756ee7ef7056a58fa61b4dbade6/cartopy_convert.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">cartopy_convert.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="plot_clip.html" title="previous page">Clip Vector Data with GeoPandas</a>
    <a class='right-next' id="next-link" href="../docs.html" title="next page">Documentation</a>

              </div>
              
          </main>
          

      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    <footer class="footer mt-5 mt-md-0">
  <div class="container">
    <p>
          &copy; Copyright 2013–2019, GeoPandas developers.<br/>
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>